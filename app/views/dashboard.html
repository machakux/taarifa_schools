<div style="text-align:right">
  <button type="submit" class="btn btn-success btn-sm" onclick="window.print();">
    <span class="glyphicon glyphicon-print"></span> {{"Print"|translate}}</button>
</div>

<tabset>
    <tab heading="{{'National'|translate}}" ng-controller="NationalDashboardCtrl" active="dashTabs.national.active" select="refreshView()">
        <div class="row">
            
            <div gridster="gridsterOpts">
                <ul>
                    
                    <li gridster-item="item" ng-repeat="item in gridLayout.tiles">
                        <div class="tile-header">{{tiles[$index][0] || 'unknown' | translate | titlecase}}</div>
                        <small translate>Percentage pass</small><br />
                        <span class="tile-number">{{tiles[$index][1].percent | number:2 }} %</span><br />
                        <div>
                            <small translate>Previous year</small>:
                            <span class="tile-info">{{tiles[$index][1].percentLast| number:2 }} %</span>
                        </div>
                        <div>
                            <small translate>Change</small>:
                            <span class="tile-info">{{tiles[$index][1].passChange | number:2 }} %</span>                        
                        </div>
                    </li>
                    
                    <li gridster-item="gridLayout.count">
                        <div class="tile-header" translate>Number of schools</div>
                        <div class="text-left">
                            <small>
                                <span translate>Total</span>: {{ schoolsTotal }}<br>
                                <span ng-repeat="school_type in typeCount">
                                    <span translate class="text-capitalize">{{ school_type.school_type }}</span>: {{ school_type.count }}{{$last ? '' : ', '}}                            
                                </span>

                            </small>                        
                        </div>

                        <div id="typeCountDonutChart"></div>
                    </li>

                    <li gridster-item row="gridLayout.totals.row" col="gridLayout.totals.col" size-x="gridLayout.totals.sizeX" size-y="gridLayout.totals.sizeY">
                        <div class="row">
                            <div class="col-sm-6 bordered-right">
                                <h4 translate>Primary</h4>
                                <div>
                                    <p><small translate>Number of candidates</small>: <strong>{{ tiles[0][1].candidates | number }}</strong></p>
                                    <p><small translate>Number of passed candidates</small>: <strong>{{ tiles[0][1].numberPass | number }}</strong></p>
                                    <hr>
                                    <p>
                                        <small translate>No. of school with more than 10% improvement</small><br>
                                        <strong>{{ improvedThan.primary.count }}</strong>
                                        <span class="text-muted">/ {{ improvedThan.primary.percent| number:2 }}%</span>
                                    </p>
                                    <hr>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <h4 translate>Secondary</h4>
                                <div>
                                    <p><small translate>Number of candidates</small>: <strong>{{ tiles[1][1].candidates | number }}</strong></p>
                                    <p><small translate>Number of passed candidates</small>: <strong>{{ tiles[1][1].numberPass | number }}</strong></p>
                                    <hr>
                                    <p>
                                        <small translate>No. of school with more than 10% improvement</small><br>
                                        <strong>{{ improvedThan.secondary.count }}</strong>
                                        <span class="text-muted">/ {{ improvedThan.secondary.percent| number:2 }}%</span>
                                    </p>
                                    <hr>
                                </div>
                            </div>
                        </div>

                        <div class="row" style="margin: 10px">
                            <div class="col-lg-12">
                                <form role="from" class="form-inline">
                                    <div class="form-group">
                                        <small>
                                            <label>Schools with </small></label>
                                            <select id="passGoalCampratorSelect" class="form-control" ng-model="passGoalComparator"
                                                    ng-options="item.label for item in numberComparators track by item.value" ng-change="onGoalUpdated(passGoalLimit, passGoalComparator)">
                                            </select>
                                            <select id="passGoalLimitSelect" class="form-control" ng-model="passGoalLimit"
                                                    ng-options="item for item in passGoalLimits" ng-change="onGoalUpdated(passGoalLimit, passGoalComparator)">
                                            </select>
                                            % pass
                                        </small>
                                    </div>
                                </form>
                                <hr>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6 bordered-right">
                                <div class="container-fluid">
                                    <p class="tile-info"><strong>{{ reachedGoal.primary.percent | number:2}} %</strong></p>
                                    <p>{{ reachedGoal.primary.count | number }} Schools</p>
                                </div>
                                <div class="container-fluid">
                                    <hr>
                                    <small>Last year</small>:
                                    <strong><small>{{ reachedGoal.primaryLast.count | number }} Schools</small></strong>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="container-fluid">
                                    <p class="tile-info"><strong>{{ reachedGoal.secondary.percent | number:2}} %</strong></p>
                                    <p>{{ reachedGoal.secondary.count | number }} Schools</p>
                                </div>
                                
                                <div class="container-fluid">
                                    <hr>
                                    <small>Last year</small>:
                                    <strong><small>{{ reachedGoal.secondaryLast.count | number }} Schools</small></strong>
                                </div>
                            </div>
                        </div>
                    </li>

                    <li gridster-item="item" ng-repeat="item in gridLayout.plots" class="gridster-item-chart">
                        <div class="panel panel-default plot">
                            <div class="panel-heading">
                                <h3 class="panel-title">{{plots[$index].title | translate}}</h3>
                            </div>
                            
                            <div class="panel-body" id="{{plots[$index].id}}">
                                <div class="row">
                                    <div class="col-sm-12 text-right">
                                        <form class="form-inline" role="form">
                                            <div class="checkbox inline-fields" ng-repeat="school_type in schoolTypes">
                                                <label for="{{ school_type }}-choice">
                                                    <input type="radio" id="{{ school_type }}-choice" ng-model="schoolTypeChoice"
                                                            value="{{ school_type }}" ng-click="onSchoolTypeSelected($event)" name="school_type">
                                                        {{ school_type }}
                                                </label>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>

                    <li gridster-item="gridLayout.topPrimary">
                        <strong translate>Top Primary schools</strong>
                        <div class="table-responsive" style="max-height: 95%; overflow-y: auto">
                            <table class="table table-hover table table-striped table-info">
                                <thead>
                                    <tr class="success">
                                        <th translate>Rank</th>
                                        <th class="text-justify" translate>School name</th>
                                        <th class="text-justify" translate>Region</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="school in topSchoolsPrimary" class="">
                                        <td>{{ school.national_rank }}</td>
                                        <td class="text-justify"><small>{{ school.name }}</small></td>
                                        <td class="text-justify"><small>{{ school.region }}</small></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </li>
                    <li gridster-item="gridLayout.topSecondary">
                        <strong translate>Top Secondary schools</strong>
                        <div class="table-responsive" style="max-height: 95%; overflow-y: auto">
                            <table class="table table-hover table table-striped table-info">
                                <thead>
                                    <tr class="success">
                                        <th translate>Rank</th>
                                        <th class="text-justify" translate>School name</th>
                                        <th class="text-justify" translate>Region</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="school in topSchoolsSecondary" class="">
                                        <td>{{ school.national_rank }}</td>
                                        <td class="text-justify"><small>{{ school.name }}</small></td>
                                        <td class="text-justify"><small>{{ school.region }}</small></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </tab>

    <!-- FIXME: controller does not belong here. Adopt: https://stackoverflow.com/a/21019370 -->
    <tab heading="{{'Primary'|translate}}" select="initView()" ng-controller="PrimaryDashboardCtrl" active="dashTabs.primary.active">
        <div class="row">
              <div id="" class="">
                <form class="form-inline" role="form" style="padding: 10px">
                  <div class="form-group">
                      <label for="regionSelectPrimary" translate>Region</label>:
                      <select id="regionSelectPrimary" ng-model="region" ng-options="v for v in regions"
                        ng-change="refreshView()" class="form-control">
                      </select>
                  </div>
                </form>
              </div>
        </div>
        
        <div class="row">
            <div gridster="gridsterOpts">
                <ul>
                    <li gridster-item="gridLayout.tiles[0]">
                        <div class="tile-header" translate>Percentage Pass</div>
                        <div><small translate>(Percentage)</small></div>
                        <div class="tile-number">{{ percentagePass['this']|number:2 }} %</div>
                        <div><small translate>Change from previous year</small></div>
                        <div>{{ percentagePass['change']|number:2 }} %</div>
                    </li>
                    <li gridster-item="gridLayout.tiles[1]">
                        <div class="tile-header" translate>Percentage Pass previuos year</div>
                        <div><small translate>(Percentage)</small></div>
                        <div class="tile-number">{{ percentagePass['last']|number:2 }} %</div>
                        <div><small translate>Change from previous year</small></div>
                        <div>{{ percentagePass['changeLast']|number:2 }} %</div>
                    </li>
                    
                    <li gridster-item row="gridLayout.map.row" col="gridLayout.map.col" size-x="gridLayout.map.sizeX"
                            size-y="gridLayout.map.sizeY">
                    </li>

                    
                    <li gridster-item="gridLayout.top">
                        <strong>Top schools</strong>
                        <div class="table-responsive" style="max-height: 95%; overflow-y: auto">
                            <table class="table table-hover table table-striped table-info">
                                <thead>
                                    <tr class="success">
                                        <th translate>Position</th>
                                        <th class="text-justify" translate>School name</th>
                                        <th class="text-right" translate><small>National rank</small></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="school in topSchools" class="">
                                        <td>{{$index+1}}</td>
                                        <td class="text-justify"><small>{{ school.name }}</small></td>
                                        <td class="text-right">{{school.national_rank}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </li>
                    
                    <li gridster-item="item" ng-repeat="item in gridLayout.plots" class="gridster-item-chart" >
                        <div class="panel panel-default plot">
                            <div class="panel-heading">
                                <h3 class="panel-title">{{plots[$index].title | translate}}</h3>
                            </div>
                            
                            <div class="panel-body" id="{{plots[$index].id}}">
                            </div>
                        </div>
                    </li>
                    
                </ul>
            </div>
        </div>
    </tab>

    <!-- FIXME: controller does not belong here. Adopt: https://stackoverflow.com/a/21019370 -->
    <tab heading="{{'Secondary'|translate}}" select="initView()" ng-controller="SecondaryDashboardCtrl" active="dashTabs.secondary.active">
        <div class="row">
              <div id="" class="">
                <form class="form-inline" role="form" style="padding: 10px">
                  <div class="form-group">
                      <label for="regionSelectPrimary" translate>Region</label>:
                      <select id="regionSelectPrimary" ng-model="region" ng-options="v for v in regions"
                        ng-change="refreshView()" class="form-control">
                      </select>
                  </div>
                </form>
              </div>
        </div>
        
        <div class="row">
            <div gridster="gridsterOpts">
                <ul>
                    <li gridster-item="gridLayout.tiles[0]">
                        <div class="tile-header" translate>Percentage Pass</div>
                        <div><small translate>(Percentage)</small></div>
                        <div class="tile-number">{{ percentagePass['this']|number:2 }} %</div>
                        <div><small translate>Change from previous year</small></div>
                        <div>{{ percentagePass['change']|number:2 }} %</div>
                    </li>
                    <li gridster-item="gridLayout.tiles[1]">
                        <div class="tile-header" translate>Percentage Pass previuos year</div>
                        <div><small translate>(Percentage)</small></div>
                        <div class="tile-number">{{ percentagePass['last']|number:2 }} %</div>
                        <div><small translate>Change from previous year</small></div>
                        <div>{{ percentagePass['changeLast']|number:2 }} %</div>
                    </li>
                    
                    <li gridster-item row="gridLayout.map.row" col="gridLayout.map.col" size-x="gridLayout.map.sizeX"
                            size-y="gridLayout.map.sizeY">
                    </li>

                    
                    <li gridster-item="gridLayout.top">
                        <strong>Top schools</strong>
                        <div class="table-responsive" style="max-height: 95%; overflow-y: auto">
                            <table class="table table-hover table table-striped table-info">
                                <thead>
                                    <tr class="success">
                                        <th translate>Position</th>
                                        <th class="text-justify" translate>School name</th>
                                        <th class="text-right" translate><small>National rank</small></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="school in topSchools" class="">
                                        <td>{{$index+1}}</td>
                                        <td class="text-justify"><small>{{ school.name }}</small></td>
                                        <td class="text-right">{{school.national_rank}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </li>
                    
                    <li gridster-item="item" ng-repeat="item in gridLayout.plots" class="gridster-item-chart" >
                        <div class="panel panel-default plot">
                            <div class="panel-heading">
                                <h3 class="panel-title">{{plots[$index].title | translate}}</h3>
                            </div>
                            
                            <div class="panel-body" id="{{plots[$index].id}}">
                            </div>
                        </div>
                    </li>
                    
                </ul>
            </div>
        </div>
    </tab>

</tabset>
